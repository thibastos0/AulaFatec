package exemploAdapter.service;

import java.io.FileOutputStream;
import java.io.StringReader;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;

// Imports para OpenPDF
import com.lowagie.text.Document;
import com.lowagie.text.PageSize;
import com.lowagie.text.pdf.PdfWriter;
import com.lowagie.text.html.simpleparser.HTMLWorker;;

public class SalesReportGenerator {

       public void generate() {
        // Conteúdo HTML
        String html = "<h1>Conteúdo do relatório</h1><p>Gerado automaticamente.</p>";

        // Define o diretório onde salvar o PDF (pasta ExemploAdapter)
        String projectDir = System.getProperty("user.dir");
        
        // Garante que termina com separador de arquivo
        if (!projectDir.endsWith(System.getProperty("file.separator"))) {
            projectDir += System.getProperty("file.separator");
        }
        
        // Nome do arquivo com timestamp
        String filename = projectDir + "relatorio_" + DateTimeFormatter.ofPattern("yyyyMMddHHmmss").format(LocalDateTime.now()) + ".pdf";

        // Cria o documento A4 (paisagem opcional)
        Document document = new Document(PageSize.A4.rotate()); // use PageSize.A4 se quiser retrato

        try {
            PdfWriter.getInstance(document, new FileOutputStream(filename));
            document.open();

            // Converte o HTML simples em PDF
            HTMLWorker htmlWorker = new HTMLWorker(document);
            htmlWorker.parse(new StringReader(html));

            document.close();
            htmlWorker.close();
            
            System.out.println("=================================");
            System.out.println("PDF gerado com sucesso!");
            System.out.println("Local: " + filename);
            System.out.println("Pasta: " + projectDir);
            System.out.println("=================================");
        } catch (Exception e) {
            System.err.println("Erro ao gerar PDF: " + e.getMessage());
            e.printStackTrace();
        }
    }


}
